{"version":3,"sources":["Login.js","Player.js","TrackSearchResult.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","trackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","title","artist","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","console","log","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f9b97a45.chunk.js","sourcesContent":["import React from 'react'\r\nimport { Container } from \"react-bootstrap\"\r\nconst AUTH_URL=\"https://accounts.spotify.com/authorize?client_id=d250697bb15c4b7eb3448f43218e067e&response_type=code&redirect_uri=http://localhost:3000&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\" \r\n\r\nexport default function Login() {\r\n    return (\r\n   \r\n   <Container className=\"d-flex justify-content-center align-items-center\"\r\n    style={{ minHeight : \"100vh\" }}\r\n   >\r\n    <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\r\n       Login with spotify\r\n   </a>\r\n   </Container> \r\n    )\r\n        \r\n}\r\n\r\n\r\n","import { useState, useEffect } from \"react\"\r\nimport SpotifyPlayer from \"react-spotify-web-playback\"\r\n\r\nexport default function Player({ accessToken, trackUri }) {\r\n  const [play, setPlay] = useState(false)\r\n\r\n  useEffect(() => setPlay(true), [trackUri])\r\n\r\n  if (!accessToken) return null\r\n  return (\r\n    <SpotifyPlayer\r\n      token={accessToken}\r\n      showSaveIcon\r\n      callback={state => {\r\n        if (!state.isPlaying) setPlay(false)\r\n      }}\r\n      play={play}\r\n      uris={trackUri ? [trackUri] : []}\r\n    />\r\n  )\r\n    }","import React from 'react'\r\n\r\n\r\nexport default  function trackSearchResult({track,chooseTrack}) {\r\n    function handlePlay()\r\n   {\r\n       chooseTrack(track)\r\n   }\r\n    return (\r\n        <div className=\"d-flex m-2 align-items-center\"\r\n        style={{cursor: \"pointer\"}}\r\n        onClick = {handlePlay}\r\n        >\r\n            <img src={track.albumUrl} style={{height: '64px',width:'64px'}}\r\n        />\r\n  <div className=\"ms-3\" >\r\n            <div>\r\n                {track.title}</div>\r\n            <div className=\"text-muted\">{track.artist}</div>\r\n            </div>\r\n        </div>\r\n        \r\n    \r\n \r\n        )\r\n}\r\n \r\n\r\n\r\n","import React from 'react'\r\nimport { useState,useEffect } from 'react'\r\nimport useAuth from './useAuth'\r\nimport Player from \"./Player\" \r\nimport {Container,Form} from 'react-bootstrap'\r\nimport SpotifyWebApi from 'spotify-web-api-node'\r\nimport TrackSearchResult from './TrackSearchResult'\r\nimport axios from 'axios'\r\nconst spotifyApi = new SpotifyWebApi(\r\n{\r\nclientId:\" d250697bb15c4b7eb3448f43218e067e\"\r\n})\r\n\r\nexport default function Dashboard ({code})\r\n {\r\n  const accessToken=useAuth(code) \r\n  const[search,setSearch]= useState(\" \") \r\n  const[searchResults,setSearchResults]=useState([]) \r\n  const[playingTrack,setPlayingTrack]=useState([]) \r\n  const[lyrics,setLyrics]=useState([]) \r\n  \r\n  function chooseTrack(track){\r\n  \r\n    setPlayingTrack(track)\r\n    setSearch('')\r\n  }\r\n  useEffect(()=>{\r\n    if(!playingTrack) return \r\n    axios.get('http://localhost:3001/lyrics',{\r\n      params:{\r\n        track:playingTrack.title,\r\n        artist:playingTrack.artist\r\n\r\n      }\r\n    \r\n  }).then(res =>{\r\n    setLyrics(res.data.lyrics)\r\n  })\r\n\r\n},[playingTrack])\r\n  useEffect(() => {\r\n    if(!accessToken) return  \r\n    spotifyApi.setAccessToken(accessToken)\r\n  }, [accessToken])\r\n\r\n  useEffect(() => { \r\n    console.log(search,accessToken)\r\n  if (!search) return setSearchResults([])\r\n  if(!accessToken) return\r\n\r\nlet cancel=false\r\n\r\n  spotifyApi.searchTracks(search).then(res =>{\r\n    if(cancel) return\r\n    setSearchResults(res.body.tracks.items.map(track => {\r\n\r\n  const smallestAlbumImage=track.album.images.reduce(\r\n  (smallest,image) => {\r\n    if(image.height < smallest.height) return image \r\nreturn smallest  \r\n},track.album.images[0])\r\n\r\n return{\r\n  artist:track.artists[0].name,\r\ntitle:track.name,\r\nuri:track.uri,\r\nalbumUrl:smallestAlbumImage.url \r\n}\r\n})\r\n)\r\n})\r\nreturn () => cancel = true\r\n}, [search,accessToken])\r\n\r\n\r\n  return(\r\n      \r\n    <Container className =\"d-flex flex-column py-2\"\r\n     style={{height:'100vh'}}>\r\n           <Form.Control\r\n            type=\"search\"\r\n            placeholder =\"Search Songs/Artists\" \r\n   value ={search}\r\n    onChange={e=> setSearch(e.target.value)}\r\n    />\r\n    <div className=\"flex-grow-1 my-2\" style={{ overflowY:\"auto\"}}>\r\n{searchResults.map(track =>(\r\n\r\n<TrackSearchResult track ={track} key={track.uri}\r\nchooseTrack={chooseTrack}\r\n/>\r\n\r\n))}\r\n {searchResults.length === 0 && (\r\n  \r\n  <div className=\"text-center\" style={{whiteSpace:\"pre\"}}>\r\n  {lyrics}\r\n  </div>\r\n  )}\r\n    </div>\r\n   \r\n    <div>\r\n    <Player accessToken={accessToken} trackUri={playingTrack?.uri}/>\r\n    </div>\r\n    </Container>\r\n    )\r\n}\r\n\r\n \r\n","\r\nimport {useState,useEffect } from 'react'\r\nimport axios from 'axios'\r\nexport default function useAuth(code) {\r\n    const[accessToken,setAccessToken]= useState()\r\n    const[refreshToken,setRefreshToken] = useState()\r\n    const[expiresIn,setExpiresIn] = useState()\r\nconsole.log(refreshToken)\r\n\r\n\r\n    useEffect(() => {\r\n    \r\naxios.post('http://localhost:3001/login',\r\n{\r\ncode,\r\n}).then(res => {\r\n    setAccessToken(res.data.accessToken)\r\n    setRefreshToken(res.data.refreshToken)\r\n    setExpiresIn(res.data.expiresIn)\r\n    window.history.pushState( { }, null,\"/\")\r\n}).catch(() => {\r\nwindow.location =\"/\"\r\n})\r\n }, [code])\r\n\r\n\r\n useEffect(()=>{\r\nif (!refreshToken ||! expiresIn) return\r\nconst interval=setInterval(()=> { \r\naxios\r\n.post('http://localhost:3001/refresh',\r\n    {\r\n    refreshToken,\r\n    })\r\n    .then(res => {\r\n       setAccessToken(res.data.accessToken)\r\n       setExpiresIn(res.data.expiresIn)\r\n    \r\n    })\r\n    .catch(() => {\r\n    window.location = \"/\"\r\n    }) \r\n \r\n    \r\n } ,(expiresIn - 60) * 1000)\r\n    return () => clearInterval(interval)\r\n\r\n},[refreshToken,expiresIn])\r\n   \r\n    return accessToken\r\n\r\n}","\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport Login from './Login'\nimport Dashboard from \"./Dashboard\"\nconst code = new URLSearchParams(window.location.search).get('code')\n\n\n\nfunction App() {\n  \n  return code ? <Dashboard code={code} /> : <Login/>\n\n}\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}